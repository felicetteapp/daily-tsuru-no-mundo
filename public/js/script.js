var v={d:(i,t)=>{for(var e in t)v.o(t,e)&&!v.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:t[e]})},o:(i,t)=>Object.prototype.hasOwnProperty.call(i,t)},T={};v.d(T,{k:()=>x,z:()=>p});var p=class i{get isThumbnailLoaded(){return this.thumbnailLoaded}get isImgLoaded(){return this.imgLoaded}get isThumbnailLoading(){return this.thumbnailLoading}get isImgLoading(){return this.imgLoading}constructor({fullsize:t,thumbnail:e,onLoaded:s,onError:r,parent:n,imgWidth:o,imgHeight:a,node:m,aspectRatio:u,mainColor:c}){this.imgEl=new Image,this.thumbnailEl=new Image,this.thumbnail="",this.loaded=!1,this.error=!1,this.imgWidth=0,this.imgHeight=0,this.mainColor="",this.aspectRatio="1/1",this.thumbnailLoaded=!1,this.imgLoaded=!1,this.thumbnailLoading=!1,this.imgLoading=!1,this.fullsize=t,this.thumbnail=e,this.onLoaded=s,this.onError=r,this.parent=n,this.imgWidth=o,this.imgHeight=a,this.node=m,this.aspectRatio=u||"1/1",this.mainColor=c||"",this.imgEl=new Image,this.thumbnailEl=new Image,this.thumbnailEl.width=this.imgWidth,this.thumbnailEl.height=this.imgHeight,this.imgEl.width=this.imgWidth,this.imgEl.height=this.imgHeight,this.node.style.cssText="",this.node.style.setProperty(`--${this.parent.withPrefix("main-color")}`,this.mainColor),this.node.style.setProperty(`--${this.parent.withPrefix("aspect-ratio")}`,this.aspectRatio),this.addClass("thumbnail",this.thumbnailEl),this.addClass("img",this.imgEl),this.addClass("item"),this.addClass("item--initialized"),this.node.innerHTML="",this.imgEl.onload=()=>{var d;this.addClass("item--img-loaded"),this.removeClass("item--img-loading"),this.imgLoaded=!0,(d=this.onLoaded)===null||d===void 0||d.call(this,this)},this.imgEl.onerror=()=>{var d;this.addClass("item--img-error"),this.removeClass("item--img-loading"),this.error=!0,(d=this.onError)===null||d===void 0||d.call(this,this)},this.thumbnailEl.onload=()=>{this.addClass("item--thumbnail-loaded"),this.removeClass("item--thumbnail-loading"),this.addClass("item--img-loading"),this.thumbnailLoaded=!0,this.imgEl.src=this.fullsize},this.parent.intersectionObserver?this.parent.intersectionObserver.observe(this.node):this.load()}withPrefix(t){return this.parent.withPrefix(t)}addClasses(t,e=this.node){t.forEach(s=>{e.classList.add(this.withPrefix(s))})}removeClasses(t,e=this.node){t.forEach(s=>{e.classList.remove(this.withPrefix(s))})}addClass(t,e=this.node){this.addClasses([t],e)}removeClass(t,e=this.node){this.removeClasses([t],e)}load(){this.addClass("item--thumbnail-loading"),this.thumbnailEl.src=this.thumbnail,this.node.appendChild(this.imgEl),this.node.appendChild(this.thumbnailEl),this.parent.intersectionObserver.unobserve(this.node)}destroy(){this.parent.intersectionObserver&&this.parent.intersectionObserver.unobserve(this.node),this.node.remove()}static elementHasCorrectData(t,e){let s=i.propsToCheck.every(r=>t.hasAttribute(e(r)));if(!s){let r=i.propsToCheck.filter(n=>!t.hasAttribute(e(n))).map(n=>e(n));console.error(`Element is missing the following attributes: ${r.join(", ")}`,t)}return s}static extractDataFromAttributes(t,e){return i.elementHasCorrectData(t,e)?{thumbnail:t.getAttribute(e("thumbnail")),fullsize:t.getAttribute(e("fullsize")),imgWidth:parseFloat(t.getAttribute(e("width"))),imgHeight:parseFloat(t.getAttribute(e("height"))),aspectRatio:t.getAttribute(e("aspect-ratio"))||"1/1",mainColor:t.getAttribute(e("main-color"))||""}:null}static fromNode(t,e){let s=i.extractDataFromAttributes(t,e.withPrefix.bind(e));return s?new i({...s,parent:e,node:t}):null}};p.propsToCheck=["thumbnail","fullsize"];var x=class{constructor(){this.elements=[],this.items=[],this.imagesContainer=null,this.prefix="il",this.intersectionObserver=null}withPrefix(t){return`${this.prefix}-${t}`}getElements(t){return typeof t=="string"?document.querySelectorAll(t):t instanceof HTMLElement||t instanceof Element?document.querySelectorAll(t.tagName):t instanceof NodeList?t:t instanceof HTMLCollection?document.querySelectorAll(Array.from(t).map(e=>e.tagName).join(",")):Array.isArray(t)?document.querySelectorAll(t.map(e=>e.tagName).join(",")):t instanceof Object&&"length"in t?document.querySelectorAll(Array.from(t).map(e=>e.tagName).join(",")):document.querySelectorAll("")}getHtmlElementFromNode(t){this.elements=Array.from(t)}getItemsFromElements(){this.items=this.elements.map(t=>p.fromNode(t,this)).filter(Boolean)}init(t,e={}){let s=Object.assign({prefix:"il"},e);this.prefix=s.prefix,this.imagesContainer=s.container||null,this.imagesContainer&&(this.intersectionObserver=new IntersectionObserver(r=>{r.forEach(n=>{if(n.isIntersecting){let o=this.items.find(a=>a.node===n.target);o&&(o.isImgLoaded&&o.isThumbnailLoaded||o.load())}},{root:this.imagesContainer})})),this.getHtmlElementFromNode(this.getElements(t)),this.getItemsFromElements()}},$=T.k,tt=T.z;var B=[],P=async i=>await(await fetch(i)).json();P("public/data/tsurusGifs.json").then(i=>{i.forEach(t=>{B.push(t)})});var D=i=>{if(!i.currentTarget)return;let e=i.currentTarget.getAttribute("t-gif-uuid"),s=document.querySelector(`[t-uuid="${e}"]`);if(!s)return;s.classList.toggle("tsuru--overlay-open");let r=s.querySelector(".tsuru__overlay > [t-overlay-gif-image]"),n=B.find(a=>a.uuid===e),o=n?n.path:void 0;!r||!o||(r.src=o)},R=()=>{document.querySelectorAll("[t-gif-btn]").forEach(t=>{t.addEventListener("click",D)})};window.addEventListener("load",R);var b=[],y=[],E=[],L=[],w=[],I,M,O=[],z=async i=>await(await fetch(i)).json();z("public/data/similarColorsUuids.json").then(i=>{i.forEach(t=>{O.push(t)})});var F=(i,t)=>t.length===0?i:Array.from(i).filter(s=>t.includes(s.getAttribute("t-date-year")??"")),W=(i,t)=>t.length===0?i:Array.from(i).filter(s=>t.includes(s.getAttribute("t-date-month")??"")),j=(i,t)=>t.length===0?i:Array.from(i).filter(s=>{let r=s.getAttribute("t-location")?.split("-")??[],n=r[r.length-1].trim();return t.includes(n)}),Y=(i,t)=>t.length===0?i:Array.from(i).filter(s=>{let r=s.getAttribute("t-location")??"";return t.some(n=>r.includes(n))}),X=(i,t)=>t.length===0?i:Array.from(i).filter(s=>t.some(r=>O.find(({color:o})=>o===r)?.tsurus.includes(s.getAttribute("t-uuid")??""))),G=i=>{let t=i.target,e=t.getAttribute("t-filter-type")||"",s=t.getAttribute("t-filter-value")||"",r=document.querySelectorAll("[t-item]");t.classList.toggle("filter--active"),e==="year"&&(b.includes(s)?b.splice(b.indexOf(s),1):b.push(s)),e==="month"&&(y.includes(s)?y.splice(y.indexOf(s),1):y.push(s)),e==="country"&&(E.includes(s)?E.splice(E.indexOf(s),1):E.push(s)),e==="color"&&(L.includes(s)?L.splice(L.indexOf(s),1):L.push(s)),e==="city"&&(w.includes(s)?w.splice(w.indexOf(s),1):w.push(s));let n=F(r,b),o=W(n,y),a=j(o,E),m=Y(a,w),u=X(m,L);r.forEach(c=>{c.style.display="none"}),Array.from(u).forEach(c=>{c.style.display=""}),document.documentElement.scrollTo({top:0,behavior:"smooth"})},U=()=>{document.body.classList.toggle("filter--open")},J=()=>{I=document.querySelectorAll("[t-filter-btn]"),M=document.querySelector("[t-filter-toggle-btn]"),!(!I||!M)&&(M.addEventListener("click",U),I.forEach(i=>{i.addEventListener("click",G)}))};window.addEventListener("load",J);var h=null,g=!1,k=()=>{document.querySelectorAll(".tsuru--selected").forEach(t=>{t.classList.remove("tsuru--selected")})},V=()=>{if(g||h===null)return;g=!0;let i=document.querySelector(`[il-uuid="${h}"]`);if(!i)return;let t=i.getAttribute("il-aspect-ratio"),e=i.getAttribute("il-fullsize"),s=document.querySelector(".modal__image");if(!t||!e||!s)return;document.documentElement.style.setProperty("--modal-img-src",`url(/${e})`);let r=i.getBoundingClientRect(),n={top:r.top,left:r.left,width:r.width,height:r.height},o=document.querySelector(".modal");if(!o)return;o.animate([{backgroundColor:"rgba(0, 0, 0, 1)"},{backgroundColor:"rgba(0, 0, 0, 0)"}],{duration:250,delay:500,easing:"ease-out"}).finished.then(()=>{document.body.classList.remove("modal--open"),h=null,k(),g=!1});let a=t.split("/"),m=Number(a[0])/Number(a[1]),u=n.width/m,c=u-n.height;s.animate([{transform:"translateX(0) translateY(0)",width:"100dvw",height:"100dvh"},{transform:`translateX(${n.left}px) translateY(${n.top-c/2}px)`,width:`${n.width}px`,height:`${u}px`}],{duration:500,easing:"ease-out",fill:"forwards"}).finished.then(()=>{s.style.backgroundSize="cover";let l=s.animate([{transform:`translateX(${n.left}px) translateY(${n.top-c/2}px)`,width:`${n.width}px`,height:`${u}px`},{transform:`translateX(${n.left}px) translateY(${n.top}px)`,width:`${n.width}px`,height:`${n.height}px`}],{duration:500,easing:"ease-out",fill:"forwards"});l.finished.then(()=>{l.commitStyles(),l.cancel()})})},_=i=>{if(i.target!==i.currentTarget||h!==null||g)return;let e=document.documentElement.clientWidth,s=window.innerWidth-document.documentElement.clientWidth;i.preventDefault(),k();let r=document.querySelector(".modal__image"),n=i.target;if(!n)return;let o=n.getAttribute("t-uuid")||"";h=o;let a=document.querySelector(`[il-uuid="${o}"]`);if(!a||!r)return;let m=a.getAttribute("il-fullsize"),u=a.getAttribute("il-aspect-ratio");if(!m||!u){h=null;return}g=!0,document.documentElement.style.setProperty("--modal-img-src",`url(/${m})`),document.documentElement.style.setProperty("--modal-img-aspect-ratio",u),document.body.classList.add("modal--open"),n.classList.add("tsuru--selected");let c=document.documentElement.clientWidth;console.log(e,c),e!==c?document.documentElement.style.setProperty("--scroll-width",`${s}px`):document.documentElement.style.setProperty("--scroll-width","0px");let d=a.getBoundingClientRect(),l={top:d.top,left:d.left,width:d.width,height:d.height},S=document.querySelector(".modal");if(!S)return;let C=S.animate([{backgroundColor:"rgba(0, 0, 0, 0)"},{backgroundColor:"rgba(0, 0, 0, 1)"}],{duration:250,easing:"ease-out",fill:"forwards"});C.finished.then(()=>{C.commitStyles(),C.cancel()});let H=u.split("/"),q=Number(H[0])/Number(H[1]),A=l.width/q,N=A-l.height;r.style.backgroundSize="cover";let f=r.animate([{width:`${l.width}px`,height:`${l.height}px`,transform:`translateX(${l.left}px) translateY(${l.top}px)`},{transform:`translateX(${l.left}px) translateY(${l.top-N/2}px)`,width:`${l.width}px`,height:`${A}px`}],{duration:250,easing:"ease-out",fill:"forwards"});f.finished.then(()=>{f.commitStyles(),f.cancel(),r.style.backgroundSize="",r.animate([{width:`${l.width}px`,height:`${A}px`,transform:`translateX(${l.left}px) translateY(${l.top-N/2}px)`},{transform:"translateX(0) translateY(0)",width:"100dvw",height:"100dvh"}],{duration:500,easing:"ease-out",fill:"forwards"}).finished.then(()=>{f.commitStyles(),f.cancel(),g=!1})})},K=i=>{let t=Math.round(i.clientX),e=Math.round(i.clientY);document.documentElement.style.setProperty("--mouse-x",`${t}px`),document.documentElement.style.setProperty("--mouse-y",`${e}px`)},Q=()=>{document.addEventListener("mousemove",K),new $().init("[img-loading]",{container:document.body});let t=document.querySelectorAll("[t-item]"),e=document.querySelector(".modal");e&&e.addEventListener("click",V),t.forEach(r=>{r.addEventListener("click",_)}),new $().init("[img-loading-me]",{container:document.body})};window.addEventListener("load",Q);
//# sourceMappingURL=script.js.map
