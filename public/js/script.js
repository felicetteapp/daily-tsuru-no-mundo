var x={d:(i,t)=>{for(var e in t)x.o(t,e)&&!x.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:t[e]})},o:(i,t)=>Object.prototype.hasOwnProperty.call(i,t)},H={};x.d(H,{k:()=>S,z:()=>b});var b=class i{get isThumbnailLoaded(){return this.thumbnailLoaded}get isImgLoaded(){return this.imgLoaded}get isThumbnailLoading(){return this.thumbnailLoading}get isImgLoading(){return this.imgLoading}constructor({fullsize:t,thumbnail:e,onLoaded:n,onError:s,parent:o,imgWidth:r,imgHeight:l,node:d,aspectRatio:u,mainColor:c}){this.imgEl=new Image,this.thumbnailEl=new Image,this.thumbnail="",this.loaded=!1,this.error=!1,this.imgWidth=0,this.imgHeight=0,this.mainColor="",this.aspectRatio="1/1",this.thumbnailLoaded=!1,this.imgLoaded=!1,this.thumbnailLoading=!1,this.imgLoading=!1,this.fullsize=t,this.thumbnail=e,this.onLoaded=n,this.onError=s,this.parent=o,this.imgWidth=r,this.imgHeight=l,this.node=d,this.aspectRatio=u||"1/1",this.mainColor=c||"",this.imgEl=new Image,this.thumbnailEl=new Image,this.thumbnailEl.width=this.imgWidth,this.thumbnailEl.height=this.imgHeight,this.imgEl.width=this.imgWidth,this.imgEl.height=this.imgHeight,this.node.style.cssText="",this.node.style.setProperty(`--${this.parent.withPrefix("main-color")}`,this.mainColor),this.node.style.setProperty(`--${this.parent.withPrefix("aspect-ratio")}`,this.aspectRatio),this.addClass("thumbnail",this.thumbnailEl),this.addClass("img",this.imgEl),this.addClass("item"),this.addClass("item--initialized"),this.node.innerHTML="",this.imgEl.onload=()=>{var a;this.addClass("item--img-loaded"),this.removeClass("item--img-loading"),this.imgLoaded=!0,(a=this.onLoaded)===null||a===void 0||a.call(this,this)},this.imgEl.onerror=()=>{var a;this.addClass("item--img-error"),this.removeClass("item--img-loading"),this.error=!0,(a=this.onError)===null||a===void 0||a.call(this,this)},this.thumbnailEl.onload=()=>{this.addClass("item--thumbnail-loaded"),this.removeClass("item--thumbnail-loading"),this.addClass("item--img-loading"),this.thumbnailLoaded=!0,this.imgEl.src=this.fullsize},this.parent.intersectionObserver?this.parent.intersectionObserver.observe(this.node):this.load()}withPrefix(t){return this.parent.withPrefix(t)}addClasses(t,e=this.node){t.forEach(n=>{e.classList.add(this.withPrefix(n))})}removeClasses(t,e=this.node){t.forEach(n=>{e.classList.remove(this.withPrefix(n))})}addClass(t,e=this.node){this.addClasses([t],e)}removeClass(t,e=this.node){this.removeClasses([t],e)}load(){this.addClass("item--thumbnail-loading"),this.thumbnailEl.src=this.thumbnail,this.node.appendChild(this.imgEl),this.node.appendChild(this.thumbnailEl),this.parent.intersectionObserver.unobserve(this.node)}destroy(){this.parent.intersectionObserver&&this.parent.intersectionObserver.unobserve(this.node),this.node.remove()}static elementHasCorrectData(t,e){let n=i.propsToCheck.every(s=>t.hasAttribute(e(s)));if(!n){let s=i.propsToCheck.filter(o=>!t.hasAttribute(e(o))).map(o=>e(o));console.error(`Element is missing the following attributes: ${s.join(", ")}`,t)}return n}static extractDataFromAttributes(t,e){return i.elementHasCorrectData(t,e)?{thumbnail:t.getAttribute(e("thumbnail")),fullsize:t.getAttribute(e("fullsize")),imgWidth:parseFloat(t.getAttribute(e("width"))),imgHeight:parseFloat(t.getAttribute(e("height"))),aspectRatio:t.getAttribute(e("aspect-ratio"))||"1/1",mainColor:t.getAttribute(e("main-color"))||""}:null}static fromNode(t,e){let n=i.extractDataFromAttributes(t,e.withPrefix.bind(e));return n?new i({...n,parent:e,node:t}):null}};b.propsToCheck=["thumbnail","fullsize"];var S=class{constructor(){this.elements=[],this.items=[],this.imagesContainer=null,this.prefix="il",this.intersectionObserver=null}withPrefix(t){return`${this.prefix}-${t}`}getElements(t){return typeof t=="string"?document.querySelectorAll(t):t instanceof HTMLElement||t instanceof Element?document.querySelectorAll(t.tagName):t instanceof NodeList?t:t instanceof HTMLCollection?document.querySelectorAll(Array.from(t).map(e=>e.tagName).join(",")):Array.isArray(t)?document.querySelectorAll(t.map(e=>e.tagName).join(",")):t instanceof Object&&"length"in t?document.querySelectorAll(Array.from(t).map(e=>e.tagName).join(",")):document.querySelectorAll("")}getHtmlElementFromNode(t){this.elements=Array.from(t)}getItemsFromElements(){this.items=this.elements.map(t=>b.fromNode(t,this)).filter(Boolean)}init(t,e={}){let n=Object.assign({prefix:"il"},e);this.prefix=n.prefix,this.imagesContainer=n.container||null,this.imagesContainer&&(this.intersectionObserver=new IntersectionObserver(s=>{s.forEach(o=>{if(o.isIntersecting){let r=this.items.find(l=>l.node===o.target);r&&(r.isImgLoaded&&r.isThumbnailLoaded||r.load())}},{root:this.imagesContainer})})),this.getHtmlElementFromNode(this.getElements(t)),this.getItemsFromElements()}},M=H.k,Z=H.z;var B=[],q=async i=>await(await fetch(i)).json();q("public/data/tsurusGifs.json").then(i=>{i.forEach(t=>{B.push(t)})});var W=i=>{if(!i.currentTarget)return;let e=i.currentTarget.getAttribute("t-gif-uuid"),n=document.querySelector(`[t-uuid="${e}"]`);if(!n)return;n.classList.toggle("tsuru--overlay-open");let s=n.querySelector(".tsuru__overlay > [t-overlay-gif-image]"),o=B.find(l=>l.uuid===e),r=o?o.path:void 0;!s||!r||(s.src=r)},D=()=>{document.querySelectorAll("[t-gif-btn]").forEach(t=>{t.addEventListener("click",W)})};window.addEventListener("load",D);var y=[],E=[],w=[],L=[],C=[],I,N,O=[],z=async i=>await(await fetch(i)).json();z("public/data/similarColorsUuids.json").then(i=>{i.forEach(t=>{O.push(t)})});var R=(i,t)=>t.length===0?i:Array.from(i).filter(n=>t.includes(n.getAttribute("t-date-year")??"")),j=(i,t)=>t.length===0?i:Array.from(i).filter(n=>t.includes(n.getAttribute("t-date-month")??"")),F=(i,t)=>t.length===0?i:Array.from(i).filter(n=>{let s=n.getAttribute("t-location")?.split("-")??[],o=s[s.length-1].trim();return t.includes(o)}),G=(i,t)=>t.length===0?i:Array.from(i).filter(n=>{let s=n.getAttribute("t-location")??"";return t.some(o=>s.includes(o))}),U=(i,t)=>t.length===0?i:Array.from(i).filter(n=>t.some(s=>O.find(({color:r})=>r===s)?.tsurus.includes(n.getAttribute("t-uuid")??""))),Y=i=>{let t=i.target,e=t.getAttribute("t-filter-type")||"",n=t.getAttribute("t-filter-value")||"",s=document.querySelectorAll("[t-item]");t.classList.toggle("filter--active"),e==="year"&&(y.includes(n)?y.splice(y.indexOf(n),1):y.push(n)),e==="month"&&(E.includes(n)?E.splice(E.indexOf(n),1):E.push(n)),e==="country"&&(w.includes(n)?w.splice(w.indexOf(n),1):w.push(n)),e==="color"&&(L.includes(n)?L.splice(L.indexOf(n),1):L.push(n)),e==="city"&&(C.includes(n)?C.splice(C.indexOf(n),1):C.push(n));let o=R(s,y),r=j(o,E),l=F(r,w),d=G(l,C),u=U(d,L);s.forEach(c=>{c.style.display="none"}),Array.from(u).forEach(c=>{c.style.display=""}),document.documentElement.scrollTo({top:0,behavior:"smooth"})},V=()=>{document.body.classList.toggle("filter--open")},J=()=>{I=document.querySelectorAll("[t-filter-btn]"),N=document.querySelector("[t-filter-toggle-btn]"),!(!I||!N)&&(N.addEventListener("click",V),I.forEach(i=>{i.addEventListener("click",Y)}))};window.addEventListener("load",J);var g=null,f=!1,P=()=>{document.querySelectorAll(".tsuru--selected").forEach(t=>{t.classList.remove("tsuru--selected")})},X=()=>{if(f||g===null)return;f=!0;let i=document.querySelector(`[il-uuid="${g}"]`);if(!i)return;let t=i.getAttribute("il-aspect-ratio"),e=i.getAttribute("il-fullsize"),n=document.querySelector(".modal__image");if(!t||!e||!n)return;document.documentElement.style.setProperty("--modal-img-src",`url(/${e})`);let s=i.getBoundingClientRect(),o={top:s.top,left:s.left,width:s.width,height:s.height},r=document.querySelector(".modal");if(!r)return;let l=500;r.animate([{backgroundColor:"rgba(0, 0, 0, 1)"},{backgroundColor:"rgba(0, 0, 0, 0)"}],{duration:250,delay:l,easing:"ease-out"}).finished.then(()=>{document.body.classList.remove("modal--open"),g=null,P(),f=!1});let d=t.split("/"),u=Number(d[0])/Number(d[1]),c=window.innerHeight<window.innerWidth,a=k(u),h={left:(window.innerWidth-a.width)/2,top:(window.innerHeight-a.height)/2},m=i.getBoundingClientRect();n.style.backgroundSize="cover";let p=n.animate([{left:`${h.left}px`,top:`${h.top}px`,width:`${a.width}px`,height:`${a.height}px`},{left:`${m.left}px`,top:`${m.top}px`,width:`${m.width}px`,height:`${m.height}px`}],{duration:l,easing:"ease-in-out",fill:"forwards"});p.finished.then(()=>{p.commitStyles(),p.cancel(),n.style.backgroundSize=""})},k=i=>{let t=window.innerHeight<window.innerWidth,e=window.innerHeight,n=window.innerWidth,s=t?n:e*i,o=t?n/i:e;return s>n&&(s=n,o=n/i),o>e&&(o=e,s=e*i),{width:s,height:o}},_=i=>{if(i.target!==i.currentTarget||g!==null||f)return;let e=document.documentElement.clientWidth,n=window.innerWidth-document.documentElement.clientWidth;i.preventDefault(),P();let s=document.querySelector(".modal__image"),o=i.target;if(!o)return;let r=o.getAttribute("t-uuid")||"";g=r;let l=document.querySelector(`[il-uuid="${r}"]`);if(!l||!s)return;let d=l.getAttribute("il-fullsize"),u=l.getAttribute("il-aspect-ratio");if(!d||!u){g=null;return}f=!0,document.documentElement.style.setProperty("--modal-img-src",`url(/${d})`),document.documentElement.style.setProperty("--modal-img-aspect-ratio",u),document.body.classList.add("modal--open"),o.classList.add("tsuru--selected");let c=document.documentElement.clientWidth;e!==c?document.documentElement.style.setProperty("--scroll-width",`${n}px`):document.documentElement.style.setProperty("--scroll-width","0px");let a=document.querySelector(".modal");if(!a)return;let h=a.animate([{backgroundColor:"rgba(0, 0, 0, 0)"},{backgroundColor:"rgba(0, 0, 0, 1)"}],{duration:250,easing:"ease-out",fill:"forwards"});h.finished.then(()=>{h.commitStyles(),h.cancel()});let m=u.split("/"),p=Number(m[0])/Number(m[1]),A=k(p),$={left:(window.innerWidth-A.width)/2,top:(window.innerHeight-A.height)/2},v=l.getBoundingClientRect(),T=s.animate([{height:v.height+"px",width:v.width+"px",left:v.left+"px",top:v.top+"px"},{height:A.height+"px",left:$.left+"px",top:$.top+"px",width:A.width+"px"}],{duration:500,easing:"ease-in-out",fill:"forwards"});T.finished.then(()=>{T.commitStyles(),T.cancel(),s.style.backgroundSize="contain",s.style.left="0px",s.style.top="0px",s.style.width="100dvw",s.style.height="100dvh",f=!1})},K=i=>{let t=Math.round(i.clientX),e=Math.round(i.clientY);document.documentElement.style.setProperty("--mouse-x",`${t}px`),document.documentElement.style.setProperty("--mouse-y",`${e}px`)},Q=()=>{document.addEventListener("mousemove",K),new M().init("[img-loading]",{container:document.body});let t=document.querySelectorAll("[t-item]"),e=document.querySelector(".modal");e&&e.addEventListener("click",X),t.forEach(s=>{s.addEventListener("click",_)}),new M().init("[img-loading-me]",{container:document.body})};window.addEventListener("load",Q);
//# sourceMappingURL=script.js.map
