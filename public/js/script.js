var S={d:(i,t)=>{for(var e in t)S.o(t,e)&&!S.o(i,e)&&Object.defineProperty(i,e,{enumerable:!0,get:t[e]})},o:(i,t)=>Object.prototype.hasOwnProperty.call(i,t)},I={};S.d(I,{k:()=>M,z:()=>w});var w=class i{get isThumbnailLoaded(){return this.thumbnailLoaded}get isImgLoaded(){return this.imgLoaded}get isThumbnailLoading(){return this.thumbnailLoading}get isImgLoading(){return this.imgLoading}constructor({fullsize:t,thumbnail:e,onLoaded:n,onError:s,parent:r,imgWidth:o,imgHeight:a,node:c,aspectRatio:u,mainColor:h}){this.imgEl=new Image,this.thumbnailEl=new Image,this.thumbnail="",this.loaded=!1,this.error=!1,this.imgWidth=0,this.imgHeight=0,this.mainColor="",this.aspectRatio="1/1",this.thumbnailLoaded=!1,this.imgLoaded=!1,this.thumbnailLoading=!1,this.imgLoading=!1,this.fullsize=t,this.thumbnail=e,this.onLoaded=n,this.onError=s,this.parent=r,this.imgWidth=o,this.imgHeight=a,this.node=c,this.aspectRatio=u||"1/1",this.mainColor=h||"",this.imgEl=new Image,this.thumbnailEl=new Image,this.thumbnailEl.width=this.imgWidth,this.thumbnailEl.height=this.imgHeight,this.imgEl.width=this.imgWidth,this.imgEl.height=this.imgHeight,this.node.style.cssText="",this.node.style.setProperty(`--${this.parent.withPrefix("main-color")}`,this.mainColor),this.node.style.setProperty(`--${this.parent.withPrefix("aspect-ratio")}`,this.aspectRatio),this.addClass("thumbnail",this.thumbnailEl),this.addClass("img",this.imgEl),this.addClass("item"),this.addClass("item--initialized"),this.node.innerHTML="",this.imgEl.onload=()=>{var d;this.addClass("item--img-loaded"),this.removeClass("item--img-loading"),this.imgLoaded=!0,(d=this.onLoaded)===null||d===void 0||d.call(this,this)},this.imgEl.onerror=()=>{var d;this.addClass("item--img-error"),this.removeClass("item--img-loading"),this.error=!0,(d=this.onError)===null||d===void 0||d.call(this,this)},this.thumbnailEl.onload=()=>{this.addClass("item--thumbnail-loaded"),this.removeClass("item--thumbnail-loading"),this.addClass("item--img-loading"),this.thumbnailLoaded=!0,this.imgEl.src=this.fullsize},this.parent.intersectionObserver?this.parent.intersectionObserver.observe(this.node):this.load()}withPrefix(t){return this.parent.withPrefix(t)}addClasses(t,e=this.node){t.forEach(n=>{e.classList.add(this.withPrefix(n))})}removeClasses(t,e=this.node){t.forEach(n=>{e.classList.remove(this.withPrefix(n))})}addClass(t,e=this.node){this.addClasses([t],e)}removeClass(t,e=this.node){this.removeClasses([t],e)}load(){this.addClass("item--thumbnail-loading"),this.thumbnailEl.src=this.thumbnail,this.node.appendChild(this.imgEl),this.node.appendChild(this.thumbnailEl),this.parent.intersectionObserver.unobserve(this.node)}destroy(){this.parent.intersectionObserver&&this.parent.intersectionObserver.unobserve(this.node),this.node.remove()}static elementHasCorrectData(t,e){let n=i.propsToCheck.every(s=>t.hasAttribute(e(s)));if(!n){let s=i.propsToCheck.filter(r=>!t.hasAttribute(e(r))).map(r=>e(r));console.error(`Element is missing the following attributes: ${s.join(", ")}`,t)}return n}static extractDataFromAttributes(t,e){return i.elementHasCorrectData(t,e)?{thumbnail:t.getAttribute(e("thumbnail")),fullsize:t.getAttribute(e("fullsize")),imgWidth:parseFloat(t.getAttribute(e("width"))),imgHeight:parseFloat(t.getAttribute(e("height"))),aspectRatio:t.getAttribute(e("aspect-ratio"))||"1/1",mainColor:t.getAttribute(e("main-color"))||""}:null}static fromNode(t,e){let n=i.extractDataFromAttributes(t,e.withPrefix.bind(e));return n?new i({...n,parent:e,node:t}):null}};w.propsToCheck=["thumbnail","fullsize"];var M=class{constructor(){this.elements=[],this.items=[],this.imagesContainer=null,this.prefix="il",this.intersectionObserver=null}withPrefix(t){return`${this.prefix}-${t}`}getElements(t){return typeof t=="string"?document.querySelectorAll(t):t instanceof HTMLElement||t instanceof Element?document.querySelectorAll(t.tagName):t instanceof NodeList?t:t instanceof HTMLCollection?document.querySelectorAll(Array.from(t).map(e=>e.tagName).join(",")):Array.isArray(t)?document.querySelectorAll(t.map(e=>e.tagName).join(",")):t instanceof Object&&"length"in t?document.querySelectorAll(Array.from(t).map(e=>e.tagName).join(",")):document.querySelectorAll("")}getHtmlElementFromNode(t){this.elements=Array.from(t)}getItemsFromElements(){this.items=this.elements.map(t=>w.fromNode(t,this)).filter(Boolean)}init(t,e={}){let n=Object.assign({prefix:"il"},e);this.prefix=n.prefix,this.imagesContainer=n.container||null,this.imagesContainer&&(this.intersectionObserver=new IntersectionObserver(s=>{s.forEach(r=>{if(r.isIntersecting){let o=this.items.find(a=>a.node===r.target);o&&(o.isImgLoaded&&o.isThumbnailLoaded||o.load())}},{root:this.imagesContainer})})),this.getHtmlElementFromNode(this.getElements(t)),this.getItemsFromElements()}},N=I.k,nt=I.z;var W=[],z=async i=>await(await fetch(i)).json();z("public/data/tsurusGifs.json").then(i=>{i.forEach(t=>{W.push(t)})});var F=i=>{if(!i.currentTarget)return;let e=i.currentTarget.getAttribute("t-gif-uuid"),n=document.querySelector(`[t-uuid="${e}"]`);if(!n)return;n.classList.toggle("tsuru--overlay-open");let s=n.querySelector(".tsuru__overlay > [t-overlay-gif-image]"),r=W.find(a=>a.uuid===e),o=r?r.path:void 0;!s||!o||(s.src=o)},Y=()=>{document.querySelectorAll("[t-gif-btn]").forEach(t=>{t.addEventListener("click",F)})};window.addEventListener("load",Y);var y=[],E=[],L=[],x=[],C=[],B,O,D=[],j=async i=>await(await fetch(i)).json();j("public/data/similarColorsUuids.json").then(i=>{i.forEach(t=>{D.push(t)})});var X=(i,t)=>t.length===0?i:Array.from(i).filter(n=>t.includes(n.getAttribute("t-date-year")??"")),G=(i,t)=>t.length===0?i:Array.from(i).filter(n=>t.includes(n.getAttribute("t-date-month")??"")),U=(i,t)=>t.length===0?i:Array.from(i).filter(n=>{let s=n.getAttribute("t-location")?.split("-")??[],r=s[s.length-1].trim();return t.includes(r)}),V=(i,t)=>t.length===0?i:Array.from(i).filter(n=>{let s=n.getAttribute("t-location")??"";return t.some(r=>s.includes(r))}),J=(i,t)=>t.length===0?i:Array.from(i).filter(n=>t.some(s=>D.find(({color:o})=>o===s)?.tsurus.includes(n.getAttribute("t-uuid")??""))),_=i=>{let t=i.target,e=t.getAttribute("t-filter-type")||"",n=t.getAttribute("t-filter-value")||"",s=document.querySelectorAll("[t-item]");t.classList.toggle("filter--active"),e==="year"&&(y.includes(n)?y.splice(y.indexOf(n),1):y.push(n)),e==="month"&&(E.includes(n)?E.splice(E.indexOf(n),1):E.push(n)),e==="country"&&(L.includes(n)?L.splice(L.indexOf(n),1):L.push(n)),e==="color"&&(x.includes(n)?x.splice(x.indexOf(n),1):x.push(n)),e==="city"&&(C.includes(n)?C.splice(C.indexOf(n),1):C.push(n));let r=X(s,y),o=G(r,E),a=U(o,L),c=V(a,C),u=J(c,x);s.forEach(h=>{h.style.display="none"}),Array.from(u).forEach(h=>{h.style.display=""}),document.documentElement.scrollTo({top:0,behavior:"smooth"})},K=()=>{document.body.classList.toggle("filter--open")},Q=()=>{B=document.querySelectorAll("[t-filter-btn]"),O=document.querySelector("[t-filter-toggle-btn]"),!(!B||!O)&&(O.addEventListener("click",K),B.forEach(i=>{i.addEventListener("click",_)}))};window.addEventListener("load",Q);var f=null,p=!1,R=()=>{document.querySelectorAll(".tsuru--selected").forEach(t=>{t.classList.remove("tsuru--selected")})},Z=()=>{if(p||f===null)return;p=!0;let i=document.querySelector(`[il-uuid="${f}"]`);if(!i)return;let t=i.getAttribute("il-aspect-ratio"),e=i.getAttribute("il-fullsize"),n=document.querySelector(".modal__image");if(!t||!e||!n)return;document.documentElement.style.setProperty("--modal-img-src",`url(/${e})`);let s=i.getBoundingClientRect(),r={top:s.top,left:s.left,width:s.width,height:s.height},o=document.querySelector(".modal");if(!o)return;o.animate([{backgroundColor:"rgba(0, 0, 0, 1)"},{backgroundColor:"rgba(0, 0, 0, 0)"}],{duration:250,delay:500,easing:"ease-out"}).finished.then(()=>{document.body.classList.remove("modal--open"),f=null,R(),p=!1});let a=t.split("/"),c=Number(a[0])/Number(a[1]),u=r.width/c,h=u-r.height,d=window.innerHeight<window.innerWidth,l={width:d?window.innerHeight*c:window.innerWidth,height:d?window.innerHeight:window.innerWidth/c},b={left:(window.innerWidth-l.width)/2,top:(window.innerHeight-l.height)/2},m=n.animate([{transform:`translateX(${b.left}px) translateY(${b.top}px)`,width:`${l.width}px`,height:`${l.height}px`},{transform:`translateX(${r.left}px) translateY(${r.top-h/2}px)`,width:`${r.width}px`,height:`${u}px`}],{duration:500,easing:"ease-out",fill:"forwards"});m.finished.then(()=>{m.commitStyles(),m.cancel(),n.style.backgroundSize="cover";let g=n.animate([{transform:`translateX(${r.left}px) translateY(${r.top-h/2}px)`,width:`${r.width}px`,height:`${u}px`},{transform:`translateX(${r.left}px) translateY(${r.top}px)`,width:`${r.width}px`,height:`${r.height}px`}],{duration:500,easing:"ease-out",fill:"forwards"});g.finished.then(()=>{g.commitStyles(),g.cancel()})})},tt=i=>{if(i.target!==i.currentTarget||f!==null||p)return;let e=document.documentElement.clientWidth,n=window.innerWidth-document.documentElement.clientWidth;i.preventDefault(),R();let s=document.querySelector(".modal__image"),r=i.target;if(!r)return;let o=r.getAttribute("t-uuid")||"";f=o;let a=document.querySelector(`[il-uuid="${o}"]`);if(!a||!s)return;let c=a.getAttribute("il-fullsize"),u=a.getAttribute("il-aspect-ratio");if(!c||!u){f=null;return}p=!0,document.documentElement.style.setProperty("--modal-img-src",`url(/${c})`),document.documentElement.style.setProperty("--modal-img-aspect-ratio",u),document.body.classList.add("modal--open"),r.classList.add("tsuru--selected");let h=document.documentElement.clientWidth;e!==h?document.documentElement.style.setProperty("--scroll-width",`${n}px`):document.documentElement.style.setProperty("--scroll-width","0px");let d=a.getBoundingClientRect(),l={top:d.top,left:d.left,width:d.width,height:d.height},b=document.querySelector(".modal");if(!b)return;let m=b.animate([{backgroundColor:"rgba(0, 0, 0, 0)"},{backgroundColor:"rgba(0, 0, 0, 1)"}],{duration:250,easing:"ease-out",fill:"forwards"});m.finished.then(()=>{m.commitStyles(),m.cancel()});let g=u.split("/"),v=Number(g[0])/Number(g[1]),T=l.width/v,P=T-l.height;s.style.backgroundSize="cover";let $=s.animate([{width:`${l.width}px`,height:`${l.height}px`,transform:`translateX(${l.left}px) translateY(${l.top}px)`},{transform:`translateX(${l.left}px) translateY(${l.top-P/2}px)`,width:`${l.width}px`,height:`${T}px`}],{duration:250,easing:"ease-out",fill:"forwards"});$.finished.then(()=>{$.commitStyles(),$.cancel(),s.style.backgroundSize="";let k=window.innerHeight<window.innerWidth,A={width:k?window.innerHeight*v:window.innerWidth,height:k?window.innerHeight:window.innerWidth/v},q={left:(window.innerWidth-A.width)/2,top:(window.innerHeight-A.height)/2},H=s.animate([{width:`${l.width}px`,height:`${T}px`,transform:`translateX(${l.left}px) translateY(${l.top-P/2}px)`},{transform:`translateX(${q.left}px) translateY(${q.top}px)`,width:A.width+"px",height:A.height+"px"}],{duration:500,easing:"ease-out",fill:"forwards"});H.finished.then(()=>{H.commitStyles(),H.cancel(),s.style.transform="translateX(0) translateY(0)",s.style.width="100dvw",s.style.height="100dvh",p=!1})})},et=i=>{let t=Math.round(i.clientX),e=Math.round(i.clientY);document.documentElement.style.setProperty("--mouse-x",`${t}px`),document.documentElement.style.setProperty("--mouse-y",`${e}px`)},it=()=>{document.addEventListener("mousemove",et),new N().init("[img-loading]",{container:document.body});let t=document.querySelectorAll("[t-item]"),e=document.querySelector(".modal");e&&e.addEventListener("click",Z),t.forEach(s=>{s.addEventListener("click",tt)}),new N().init("[img-loading-me]",{container:document.body})};window.addEventListener("load",it);
//# sourceMappingURL=script.js.map
